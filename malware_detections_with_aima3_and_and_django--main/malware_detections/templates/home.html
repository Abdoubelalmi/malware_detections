<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Restaurant Recommendation</title>
        <style>
        body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-image: url('images/wp1874184.jpg');
    background-size: cover;
    background-repeat: no-repeat;
    color: #333;
    margin: 0;
    padding: 0;
}

.container {
    max-width: 600px;
    margin: 50px auto;
    padding: 30px;
    background-color: rgba(255, 255, 255, 0.9);
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
}

h1 {
    text-align: center;
    margin-bottom: 30px;
    color: #007bff;
}

.question-container {
    margin-bottom: 30px;
}

.question-container p {
    font-size: 18px;
    margin-bottom: 15px;
    color: #555;
}

label {
    display: block;
    margin-bottom: 15px;
}

input[type="radio"] {
    margin-right: 10px;
}

button {
    padding: 12px 25px;
    font-size: 18px;
    cursor: pointer;
    border: none;
    border-radius: 5px;
    background-color: #007bff;
    color: #fff;
    transition: background-color 0.3s, transform 0.3s;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

button:hover {
    background-color: #0056b3;
    transform: scale(1.05);
}

#result-container {
    margin-top: 30px;
}

ul {
    list-style: none;
    padding: 0;
}

ul li {
    font-size: 16px;
    margin-bottom: 10px;
    color: #555;
}

        </style>
    </head>
    
<body>
    <div class="container">
        <h1>Welcome to the Malware Detection Quiz!</h1>

        <form id="malware-quiz-form">
            {% csrf_token %}

            <div class="question-container" id="question1">
                <p>Has the system recently started encrypting files without user initiation?</p>
                <label><input type="radio" name="EncryptsFiles" value="yes"> Yes</label>
                <label><input type="radio" name="EncryptsFiles" value="no"> No</label><br>
            </div>

            <div class="question-container" id="question2">
                <p>Have there been any unauthorized modifications to the system's boot process?</p>
                <label><input type="radio" name="ModifiesBootProcess" value="yes"> Yes</label>
                <label><input type="radio" name="ModifiesBootProcess" value="no"> No</label><br>
            </div>

            <div class="question-container" id="question3">
                <p>Has the system prompted for a ransom payment to unlock files or functionalities?</p>
                <label><input type="radio" name="RequestsRansom" value="yes"> Yes</label>
                <label><input type="radio" name="RequestsRansom" value="no"> No</label><br>
            </div>

            <div class="question-container hidden" id="question4">
                <p>Is there a ransom note accessible on the system?</p>
                <label><input type="radio" name="HasRansomNote" value="yes"> Yes</label>
                <label><input type="radio" name="HasRansomNote" value="no"> No</label><br>
            </div>

            <div class="question-container hidden" id="question5">
                <p>Have there been unusual network activities detected on the system?</p>
                <label><input type="radio" name="HasNetworkActivity" value="yes"> Yes</label>
                <label><input type="radio" name="HasNetworkActivity" value="no"> No</label><br>
            </div>

            <div class="question-container hidden" id="question6">
                <p>Does the system exhibit behaviors that suggest it is trying to detect a sandbox environment?</p>
                <label><input type="radio" name="DetectsSandbox" value="yes"> Yes</label>
                <label><input type="radio" name="DetectsSandbox" value="no"> No</label><br>
            </div>

            <div class="question-container hidden" id="question7">
                <p>Have backup or shadow copies of files been deleted unexpectedly?</p>
                <label><input type="radio" name="DeletesShadowCopies" value="yes"> Yes</label>
                <label><input type="radio" name="DeletesShadowCopies" value="no"> No</label><br>
            </div>

            <div class="question-container hidden" id="question8">
                <p>Has any security software been disabled or tampered with on the system?</p>
                <label><input type="radio" name="DisablesSecuritySoftware" value="yes"> Yes</label>
                <label><input type="radio" name="DisablesSecuritySoftware" value="no"> No</label><br>
            </div>

            <div class="question-container hidden" id="question9">
                <p>Has there been any unexpected execution of PowerShell scripts?</p>
                <label><input type="radio" name="ExecutesPowershell" value="yes"> Yes</label>
                <label><input type="radio" name="ExecutesPowershell" value="no"> No</label><br>
            </div>

            <!-- Add more question-container divs for additional questions -->

            <div id="result-container" style="display: none;">
                <h2>Detected Malware:</h2>
                <p id="detected-malware"></p>
            </div>

            <button id="prev-btn" style="display: none;" type="button">Previous</button>
            <button id="next-btn" type="button">Next</button>
            <button id="submit-btn" style="display: none;" type="button">Submit</button>
        </form>
    </div>
</body>

    <script>
        const questions = document.querySelectorAll('.question-container');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const submitBtn = document.getElementById('submit-btn');
const resultContainer = document.getElementById('result-container');
const recommendedRestaurants = document.getElementById('recommended-restaurants');

let currentQuestionIndex = 0;

function showQuestion(index) {
    questions.forEach((question, idx) => {
        question.style.display = idx === index ? 'block' : 'none';
    });

    prevBtn.style.display = index === 0 ? 'none' : 'inline-block';
    nextBtn.style.display = index === questions.length - 1 ? 'none' : 'inline-block';
    submitBtn.style.display = index === questions.length - 1 ? 'inline-block' : 'none';
}

function showResult(restaurants) {
    resultContainer.style.display = 'block';
    recommendedRestaurants.innerHTML = ''; // Clear previous recommendations
    restaurants.forEach(restaurant => {
        const li = document.createElement('li');
        li.textContent = `${restaurant.name} in ${restaurant.city}`;
        recommendedRestaurants.appendChild(li);
    });
}

prevBtn.addEventListener('click', () => {
    currentQuestionIndex--;
    showQuestion(currentQuestionIndex);
});

nextBtn.addEventListener('click', () => {
    currentQuestionIndex++;
    showQuestion(currentQuestionIndex);
});

submitBtn.addEventListener('click', () => {
    const formData = new FormData(document.getElementById('quiz-form'));
    const preferences = {};
    formData.forEach((value, key) => {
        preferences[key] = value;
    });
    console.log(preferences); // Check if preferences object contains the expected data
    // Fetch request...
    // Send preferences to server
    fetch('/', {
        method: 'POST',
        headers: {
            'X-CSRFToken': getCookie('csrftoken'),
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(preferences)
    })
    .then(response => response.json())
    .then(data => {
        showResult(data.recommended_restaurants);
    })
    .catch(error => console.error('Error:', error));
});


// Function to get CSRF token from cookies
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Check if the cookie name matches the requested name
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}


showQuestion(currentQuestionIndex);

    </script>
    
</body>
</html>